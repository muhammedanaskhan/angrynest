<a name="readme-top"></a>

<p align="center">
<!-- Badges -->
  <a href="https://github.com/muhammedanaskhan">
    <img src="https://custom-icon-badges.demolab.com/badge/made%20by%20-muhammedanaskhan-556bf2?style=flat-square&logo=github&logoColor=white&labelColor=101827" alt="made by @muhammedanaskhan" />
  </a>
  <a href="https://github.com/muhammedanaskhan/communet/blob/main/LICENSE">
    <img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="license" />
  </a>
  <a href="">
    <img src="https://img.shields.io/github/last-commit/ladunjexa/nextjs13-threads" alt="last update" />
  </a>
  <a href="https://github.com/muhammedanaskhan/communet/network/members">
    <img src="https://img.shields.io/github/forks/muhammedanaskhan/communet" alt="forks" />
  </a>
  <a href="https://github.com/muhammedanaskhan/communet/stargazers">
    <img src="https://img.shields.io/github/stars/muhammedanaskhan/communet" alt="stars" />
  </a>
  <a href="https://github.com/muhammedanaskhan/communet/issues/">
    <img src="https://img.shields.io/github/issues/muhammedanaskhan/communet" alt="open issues" />
  </a>
  <a href="https://github.com/muhammedanaskhan/communet/issues/">
    <img src="https://img.shields.io/badge/PRs-welcome-pink.svg" alt="prs welcome" />
  </a>
</p>

<h1 align="center">Communet - Full Stack Social Media App</h1>

Communet web application, a social media platform where one can share thoughts, with his/her. Communet is a full-stack web application built with TypeScript using Next.js 13 with Server Side Rendering. It uses MongoDB as a database, and Clerk as an authentication provider. It also uses UploadThing to upload images to the cloud. The application is styled with Tailwind CSS and Shadcn components.

#### [View Demo](https://nextjs13-threads.vercel.app/)


### Folder Structure

<b>Threads</b> code folder structure is as follows:

```
nextjs13-threads/
‚îú‚îÄ‚îÄ app/
‚îú   ‚îú‚îÄ‚îÄ favicon.ico
‚îú   ‚îú‚îÄ‚îÄ globals.css
‚îú   ‚îú‚îÄ‚îÄ (auth)/
‚îú   ‚îú   ‚îú‚îÄ‚îÄ onboarding/
‚îú   ‚îú   ‚îú   ‚îî‚îÄ‚îÄ page.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ sign-in/[[...sign-in]]/
‚îú   ‚îú   ‚îú   ‚îî‚îÄ‚îÄ page.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ sign-up/[[...sign-up]]/
‚îú   ‚îú   ‚îú   ‚îî‚îÄ‚îÄ page.tsx
‚îú   ‚îú   ‚îî‚îÄ‚îÄ layout.tsx
‚îú   ‚îú‚îÄ‚îÄ (root)/
‚îú   ‚îú   ‚îú‚îÄ‚îÄ layout.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ page.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ activity/
‚îú   ‚îú   ‚îú   ‚îî‚îÄ‚îÄ page.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ create-thread/
‚îú   ‚îú   ‚îú   ‚îî‚îÄ‚îÄ page.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ edit-thread/[id]/
‚îú   ‚îú   ‚îú   ‚îî‚îÄ‚îÄ page.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ explore/
‚îú   ‚îú   ‚îú   ‚îî‚îÄ‚îÄ page.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ profile/
‚îú   ‚îú   ‚îú   ‚îú‚îÄ‚îÄ [id]/
‚îú   ‚îú   ‚îú   ‚îú   ‚îî‚îÄ‚îÄ page.tsx
‚îú   ‚îú   ‚îú   ‚îî‚îÄ‚îÄ edit/
‚îú   ‚îú   ‚îú       ‚îî‚îÄ‚îÄ page.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ search/
‚îú   ‚îú   ‚îú   ‚îî‚îÄ‚îÄ page.tsx
‚îú   ‚îú   ‚îî‚îÄ‚îÄ thread/
‚îú   ‚îú       ‚îú‚îÄ‚îÄ [id]/
‚îú   ‚îú       ‚îú   ‚îî‚îÄ‚îÄ page.tsx
‚îú   ‚îú       ‚îî‚îÄ‚îÄ reactions/[id]/
‚îú   ‚îú           ‚îî‚îÄ‚îÄ page.tsx
‚îú   ‚îî‚îÄ‚îÄ api/
‚îú       ‚îú‚îÄ‚îÄ uploadthing/
‚îú       ‚îú   ‚îî‚îÄ‚îÄ page.tsx
‚îú       ‚îî‚îÄ‚îÄ webhook/clerk/
‚îú              ‚îî‚îÄ‚îÄ route.tsx
‚îú‚îÄ‚îÄ components/
‚îú   ‚îú‚îÄ‚îÄ atoms/
‚îú   ‚îú   ‚îú‚îÄ‚îÄ ThreadCard.tsx
‚îú   ‚îú   ‚îî‚îÄ‚îÄ UserCard.tsx
‚îú   ‚îú‚îÄ‚îÄ cards/
‚îú   ‚îú   ‚îú‚îÄ‚îÄ FollowUser.tsx
‚îú   ‚îú   ‚îî‚îÄ‚îÄ ReactThread.tsx
‚îú   ‚îú‚îÄ‚îÄ forms/
‚îú   ‚îú   ‚îú‚îÄ‚îÄ AccountProfile.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ Comment.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ DeleteThread.tsx
‚îú   ‚îú   ‚îî‚îÄ‚îÄ PostThread.tsx
‚îú   ‚îú‚îÄ‚îÄ shared/
‚îú   ‚îú   ‚îú‚îÄ‚îÄ Bottombar.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ Topbar.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ LeftSidebar.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ RightSidebar.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ Searchbar.tsx
‚îú   ‚îú   ‚îú‚îÄ‚îÄ ProfileHeader.tsx
‚îú   ‚îú   ‚îî‚îÄ‚îÄ ThreadsTab.tsx
‚îú   ‚îî‚îÄ‚îÄ ui/ (generated by shadcn/ui)
‚îú       ‚îú‚îÄ‚îÄ button.tsx
‚îú       ‚îú‚îÄ‚îÄ form.tsx
‚îú       ‚îú‚îÄ‚îÄ input.tsx
‚îú       ‚îú‚îÄ‚îÄ label.tsx
‚îú       ‚îú‚îÄ‚îÄ tabs.tsx
‚îú       ‚îî‚îÄ‚îÄ textarea.tsx
‚îú‚îÄ‚îÄ constants/
‚îú   ‚îî‚îÄ‚îÄ index.js
‚îú‚îÄ‚îÄ lib/
‚îú   ‚îú‚îÄ‚îÄ mongoose.ts
‚îú   ‚îú‚îÄ‚îÄ uploadthing.ts
‚îú   ‚îú‚îÄ‚îÄ utils.ts
‚îú   ‚îú‚îÄ‚îÄ actions/
‚îú   ‚îú   ‚îú‚îÄ‚îÄ thread.actions.ts
‚îú   ‚îú   ‚îî‚îÄ‚îÄ user.actions.ts
‚îú   ‚îú‚îÄ‚îÄ models/
‚îú   ‚îú   ‚îú‚îÄ‚îÄ thread.model.ts
‚îú   ‚îú   ‚îî‚îÄ‚îÄ user.model.ts
‚îú   ‚îî‚îÄ‚îÄ validations/
‚îú       ‚îú‚îÄ‚îÄ thread.ts
‚îú       ‚îî‚îÄ‚îÄ user.ts
‚îú‚îÄ‚îÄ public/
‚îú   ‚îú‚îÄ‚îÄ next.svg
‚îú   ‚îú‚îÄ‚îÄ vercel.svg
‚îú   ‚îî‚îÄ‚îÄ assets/
‚îú       ‚îî‚îÄ‚îÄ [[...]].svg
‚îú‚îÄ‚îÄ components.json
‚îú‚îÄ‚îÄ middleware.ts
‚îú‚îÄ‚îÄ next.config.ts
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ postcss.config.js
‚îú‚îÄ‚îÄ tailwind.config.js
‚îú‚îÄ‚îÄ tailwind.config.js (meaningless)
‚îî‚îÄ‚îÄ tsconfig.ts
```

# üìö Libraries

- **clerk** - implmement authentication
- **uploadthing** - upload profile images
- **mongoose** - 
  - Mongoose offers a higher-level abstraction and simplification of     MongoDB operations.
  - MongoDB is schemaless, mongoose allows to define schemas, has less boilerplate, provides hooks.
- **svix** - for webhooks
- **react-hook-form** - Manage form validation easily
- **zod** - Declaring and validating Schemas, for complete guide - [https://ui.shadcn.com/docs/components/form]
- **currentUser() from clerk** - helper returns the User object of the currently active user, which is default put in onboarding form
- **uploadthing** - handles file upload + server side authentication 

# üó∫Ô∏è Layout

- Defined metadata objects in Layout Component which contains default metadata tags of the application, These metadata tags are important for search engine optimization (SEO).
- 


# üóé Account onboarding

- **{ useForm } from "react-hook-form"**: Managing forms, rovides hooks and utilities for handling form state and validation.
- **zod** is providing methods to write validation logic(schema) in a function - userValidation, which is passed to zodResolver in useForm hook
- **onSubmit()** - Re-uploads the new data(updates), in the Mongo DB 
  -  check if image is changed - use isBase64Image from utils.ts
  -  if changed - upload using package uploadthing from lib folder
  -  handle file upload using useUploadThing from uploadthing library

# üìÇ File Structure

- **Route Groups** - Grouping related routes together in folder - (folder), without affecting the URL
- **app folder** - contains both UI route and API route
- **API routes** - Custom routes to handle HTTP requests/responses
 - written in JavaScript are automatically deployed as serverless functions in the cloud. API routes provide a backend-like functionality within the frontend Next.js app,so we can build web applications without the need for a separate server.
 - We're eliminating backend API routes (NodeJs Server), because we're already rendering everything on the server-side, we have server-side rendered page having client-side components 
- **utils** - contains utility functions, that we re-use across the code 

- **thread details** - *(root) > thread > [id] > page.tsx*, dynamic route to get specific thread's info..
 - to get params, out of the url i.e, the thread-id
  ```
  const Page = ({ params } : {params: { id: string }}) => {  
  }
  ```
  - get thread data - ```fetchThreadById(params.id)``` (from *thread.actions.ts*) 
  - commenting under a thread - 


# ‚öôÔ∏è Backend

- **Server Actions** - No need to manually create API endpoints. Instead define asynchronous server functions that can be called directly from the components, Server Actions can be defined in Server Components or called from Client Components, but run only on Server.
 - *lib > actions > user.actions.ts* - // first create a connection to db using mongoose

- **MongoDB Schema** - *lib > models > user.model.ts*
  ``` 
  const userSchema = new mongoose.Schema({
      id: {type: String, required: true, unique: true},
      username: {type: String, required: true, unique: true},
      name: {type: String, required: true},
      image: String,
      bio: String,
      threads: [  // one user can have multiple references to specific threads stored in the database
          {
              type: mongoose.Schema.Types.ObjectId,
              ref: "Thread"
          }
      ],
      onboarded: {
          type: Boolean,
          default: false
      },
      communities: [
          {
              type: mongoose.Schema.Types.ObjectId,
              ref: "Community"
          }
      ]
  })

  
  ```

- **create/update user profile** - *lib > actions > user.actions.ts*, updateUser function takes in params and implements .findOneUpdate method (create or update if already exists) on useSchema object with passed params

- **fetch user profile** - *lib > actions > user.actions.ts*, fetchUser function takes in userId and finds user using .findOne method on useSchema object with passed userId.
- 
- **create thread** - 
   ![create-thread-flow](https://github.com/muhammedanaskhan/communet/assets/72510634/72d531e3-d849-4b5c-8847-aecbc4376665)



# üåê Communities

- **Web Hooks** - In order to create a community, utilized web hooks -
  - An org can be created directly through clerk, but to get org data from clerk into the application, to append additional posts to the org, web hook will be waiting and listening the events from clerk, from which one can make additional actions of modifying the DB.
